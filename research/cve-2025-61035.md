# CVE-2025-61035 â€” seffaflik: Arbitrary File Overwrite via Symlink and Insecure File Permissions (CWE-276)

## Summary
A local vulnerability in the `seffaflik` Python package (`<= 0.0.9`) allows arbitrary file overwrite through a symlink attack during identity file creation in the `seffaflik.Kimlik()` function. In addition, insecure default permissions expose sensitive identity data to other local users. This issue corresponds to **CWE-276: Incorrect Default Permissions** and can lead to both information disclosure and denial of service.

## Affected Component
- `seffaflik.Kimlik()` function (identity file creation logic)

## Affected Versions
- `seffaflik` `<= 0.0.9`

## Vulnerability Type
- Arbitrary File Overwrite via Symlink
- World-readable / world-writable secret file
- Insecure default file and directory permissions

## Impact

### Information Disclosure
The identity file `~/.seffaflik/.kimlik` is created with permission mode **0777**, and the parent directory `~/.seffaflik` with **0775**. These overly permissive settings allow other local users on the same system to read or modify sensitive identity-related data.

## Attack Vector
A local attacker can pre-create the path `~/.seffaflik/.kimlik` as a symbolic link pointing to an arbitrary target file. When the victim executes `seffaflik.Kimlik()`, the function follows the symlink and overwrites the referenced file. Because no validation or symlink protection is in place, the write operation is performed on the attacker-controlled target. The insecure permission modes further amplify the impact by exposing secrets to other local users.

## Reproduction

1. Before the identity file is generated, the attacker replaces `~/.seffaflik/.kimlik` with a symbolic link pointing to a file writable by the victim user.
2. The victim executes `seffaflik.Kimlik()`.
3. The function writes identity data to the symlink path, overwriting the target file.
4. The resulting identity file and directory permissions allow unintended read or write access by other local users.

## Root Cause
- The identity file creation logic does not prevent symlink traversal.
- File and directory permissions are set to overly permissive defaults.
- Secure, atomic file creation mechanisms are not used.

## References
- PyPI Project: https://pypi.org/project/seffaflik/
- Source Repository: https://github.com/nurisensoy/seffaflik
- CVE Link: https://www.cve.org/cverecord?id=CVE-2025-61035

## Timeline
- Discovery: 1 Sep 2025
